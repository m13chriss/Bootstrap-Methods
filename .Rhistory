library(boot)
library(AER)
library(ggplot2)
library(stats4)
library(kernelboot)
data("CPS1985")#determinants of wage data
#Comparison of characteristics 1)married and 2)gender on the wage of the employee
View(CPS1985)
d=CPS1985
#Comparison of wage by gender
boxplot(d$wage~d$gender, las=1, ylab="Wage ($)",
xlab="gender",main="Wage by Gender")
#In the case of females we have an extreme outlier which we will be dropping as it
#might effect our study
d=d[!(d$wage > 40),]
boxplot(d$wage~d$gender, las=1, ylab="Wage ($)",
xlab="gender",main="Wage by Gender")
male = d[d$gender=='male',]
female = d[d$gender=='female',]
#plotting the distribution of wage for male and female
ggplot(male, aes(x=wage))+geom_histogram(aes(y=..density..),binwidth=1,color="red", fill="grey")+geom_density(data = data.frame(wage =rchisq(50000, df=9)), col = "black")+ labs(x = "Wage ($) for Male", y = "Density")
ggplot(female,aes(x=wage)) +geom_histogram(aes(y=..density..),binwidth=1,color="red", fill="grey") +geom_density(data = data.frame(wage =rchisq(50000, df=8)), col = "black")+ labs(x = "Wage ($) for Female", y = "Density")
#mean for male and female wages
m <- d$wage[d$gender=="male"]
f <- d$wage[d$gender=="female"]
nonparam <- two.boot(male, female, mean, R = 1000)
library(boot)
nonparam <- two.boot(male, female, mean, R = 1000)
library(simpleboot)
nonparam <- two.boot(male, female, mean, R = 1000)
View(nonparam)
male = d[d$gender=='male',]
female = d[d$gender=='female',]
#plotting the distribution of wage for male and female
ggplot(male, aes(x=wage))+geom_histogram(aes(y=..density..),binwidth=1,color="red", fill="grey")+geom_density(data = data.frame(wage =rchisq(50000, df=9)), col = "black")+ labs(x = "Wage ($) for Male", y = "Density")
nonparam <- two.boot(male, female, mean, R = 1000)
female = d[d$gender=='female',"wage"]
male = d[d$gender=='male',"wage"]
nonparam <- two.boot(male, female, mean, R = 1000)
nonparam$t
hist(nonparam$t)
# let's bootstrap...
set.seed(13)   # set a seed for consistency/reproducability
n.f <- 244  # the number of observations to sample from casein
n.m <- 289  # the number of observations to sample from meatmeal
B <- 1000  # the number of bootstrap samples...go big or go home right?
# now, get those bootstrap samples (without loops!)
# stick each Boot-sample in a column...
Boot.male <- matrix( sample(male, size= B*n.m,
replace=TRUE), ncol=B, nrow=n.m)
Boot.female <- matrix( sample(female, size= B*n.f,
replace=TRUE), nrow=n.f, ncol=B)
# check to make sure they are not empty!
Boot.male[1:5,1:5]
Boot.female[1:5,1:5]
# check those
dim(Boot.male); dim(Boot.female)
# calculate the difference in MEANS for each of the bootsamples
Boot.Diff.In.Means <- colMeans(Boot.male) - colMeans(Boot.female)
# check that
length(Boot.Diff.In.Means)
# let's look at the PERCENTILE METHOD
# the "PERCENTILE" bootstrap confidence interval
# first, for the difference in MEANS
quantile(Boot.Diff.In.Means, prob=0.025)
quantile(Boot.Diff.In.Means, prob=0.975)
# let's look at the BASIC METHOD
# first, for the difference in MEANS
2*Obs.Diff.In.Means - quantile(Boot.Diff.In.Means, prob=0.975)
# let's bootstrap...
set.seed(13579)   # set a seed for consistency/reproducability
n.c <- 12  # the number of observations to sample from casein
n.m <- 11  # the number of observations to sample from meatmeal
B <- 100000  # the number of bootstrap samples...go big or go home right?
# now, get those bootstrap samples (without loops!)
# stick each Boot-sample in a column...
Boot.casein <- matrix( sample(d$weight[d$feed=="casein"], size= B*n.c,
replace=TRUE), ncol=B, nrow=n.c)
library(boot)
library(AER)
library(ggplot2)
library(stats4)
library(kernelboot)
library(simpleboot)
data("CPS1985")#determinants of wage data
#Comparison of characteristics 1)married and 2)gender on the wage of the employee
View(CPS1985)
d=CPS1985
#Comparison of wage by gender
boxplot(d$wage~d$gender, las=1, ylab="Wage ($)",
xlab="gender",main="Wage by Gender")
#In the case of females we have an extreme outlier which we will be dropping as it
#might effect our study
d=d[!(d$wage > 40),]
boxplot(d$wage~d$gender, las=1, ylab="Wage ($)",
xlab="gender",main="Wage by Gender")
male = d[d$gender=='male',"wage"]
female = d[d$gender=='female',"wage"]
#plotting the distribution of wage for male and female
ggplot(male, aes(x=wage))+geom_histogram(aes(y=..density..),binwidth=1,color="red", fill="grey")+geom_density(data = data.frame(wage =rchisq(50000, df=9)), col = "black")+ labs(x = "Wage ($) for Male", y = "Density")
ggplot(female,aes(x=wage)) +geom_histogram(aes(y=..density..),binwidth=1,color="red", fill="grey") +geom_density(data = data.frame(wage =rchisq(50000, df=8)), col = "black")+ labs(x = "Wage ($) for Female", y = "Density")
library(boot)
library(AER)
library(ggplot2)
library(stats4)
library(kernelboot)
library(simpleboot)
library(boot)
library(AER)
library(ggplot2)
library(stats4)
library(kernelboot)
library(simpleboot)
data("CPS1985")#determinants of wage data
#Comparison of characteristics 1)married and 2)gender on the wage of the employee
View(CPS1985)
d=CPS1985
#Comparison of wage by gender
boxplot(d$wage~d$gender, las=1, ylab="Wage ($)",
xlab="gender",main="Wage by Gender")
#In the case of females we have an extreme outlier which we will be dropping as it
#might effect our study
d=d[!(d$wage > 40),]
boxplot(d$wage~d$gender, las=1, ylab="Wage ($)",
xlab="gender",main="Wage by Gender")
male = d[d$gender=='male',"wage"]
female = d[d$gender=='female',"wage"]
#plotting the distribution of wage for male and female
ggplot(male, aes(x=wage))+geom_histogram(aes(y=..density..),binwidth=1,color="red", fill="grey")+geom_density(data = data.frame(wage =rchisq(50000, df=9)), col = "black")+ labs(x = "Wage ($) for Male", y = "Density")
#data frame male and female wages
m <- d$wage[d$gender=="male"]
f <- d$wage[d$gender=="female"]
#plotting the distribution of wage for male and female
ggplot(m, aes(x=wage))+geom_histogram(aes(y=..density..),binwidth=1,color="red", fill="grey")+geom_density(data = data.frame(wage =rchisq(50000, df=9)), col = "black")+ labs(x = "Wage ($) for Male", y = "Density")
ggplot(f,aes(x=wage)) +geom_histogram(aes(y=..density..),binwidth=1,color="red", fill="grey") +geom_density(data = data.frame(wage =rchisq(50000, df=8)), col = "black")+ labs(x = "Wage ($) for Female", y = "Density")
#data frame male and female wages
m <- d[d$gender=="male"]
f <- d[d$gender=="female"]
#plotting the distribution of wage for male and female
ggplot(m, aes(x=wage))+geom_histogram(aes(y=..density..),binwidth=1,color="red", fill="grey")+geom_density(data = data.frame(wage =rchisq(50000, df=9)), col = "black")+ labs(x = "Wage ($) for Male", y = "Density")
ggplot(f,aes(x=wage)) +geom_histogram(aes(y=..density..),binwidth=1,color="red", fill="grey") +geom_density(data = data.frame(wage =rchisq(50000, df=8)), col = "black")+ labs(x = "Wage ($) for Female", y = "Density")
#data frame male and female wages
m <- d[d$gender=="male",]
f <- d[d$gender=="female",]
#plotting the distribution of wage for male and female
ggplot(m, aes(x=wage))+geom_histogram(aes(y=..density..),binwidth=1,color="red", fill="grey")+geom_density(data = data.frame(wage =rchisq(50000, df=9)), col = "black")+ labs(x = "Wage ($) for Male", y = "Density")
ggplot(f,aes(x=wage)) +geom_histogram(aes(y=..density..),binwidth=1,color="red", fill="grey") +geom_density(data = data.frame(wage =rchisq(50000, df=8)), col = "black")+ labs(x = "Wage ($) for Female", y = "Density")
library(boot)
library(AER)
library(ggplot2)
library(stats4)
library(kernelboot)
library(simpleboot)
data("CPS1985")#determinants of wage data
#Comparison of characteristics 1)married and 2)gender on the wage of the employee
View(CPS1985)
d=CPS1985
#Comparison of wage by gender
boxplot(d$wage~d$gender, las=1, ylab="Wage ($)",
xlab="gender",main="Wage by Gender")
#In the case of females we have an extreme outlier which we will be dropping as it
#might effect our study
d=d[!(d$wage > 40),]
boxplot(d$wage~d$gender, las=1, ylab="Wage ($)",
xlab="gender",main="Wage by Gender")
#vector for male and female wages
male = d[d$gender=='male',"wage"]
female = d[d$gender=='female',"wage"]
#data frame male and female wages
m <- d[d$gender=="male",]
f <- d[d$gender=="female",]
#plotting the distribution of wage for male and female
ggplot(m, aes(x=wage))+geom_histogram(aes(y=..density..),binwidth=1,color="red", fill="grey")+geom_density(data = data.frame(wage =rchisq(50000, df=9)), col = "black")+ labs(x = "Wage ($) for Male", y = "Density")
ggplot(f,aes(x=wage)) +geom_histogram(aes(y=..density..),binwidth=1,color="red", fill="grey") +geom_density(data = data.frame(wage =rchisq(50000, df=8)), col = "black")+ labs(x = "Wage ($) for Female", y = "Density")
diff.means.boot <- function(d, i) {
m1 <- mean(d[i, ][d$gender=="male", "wage"])
m2 <- mean(d[i, ][d$gender=="female", "wage"])
return(m1-m2)
}
#nonparametric boot
nonparam.diff <- two.boot(male, female, mean, R = 1000)
hist(nonparam.diff$t)
#parametric boot
LL_f <- function(df) {
R = dchisq(female, df)
-sum(log(R))
}
LL_m <- function(df) {
R = dchisq(male, df)
-sum(log(R))
}
mle(LL_f, start = list(df = 1))
mle(LL_m, start = list(df = 1))
df_m <- 10
df_f <- 8
mle = c(df_f, df_m)
#Set the function that simulates data by drawing from chi-squared distribution
#with degrees of freedom taken from MLE.
gen_function <- function(x,mle) { f <- rchisq(length(x$wage[x$gender=="female"]),mle[1])
m <- rchisq(length(x$wage[x$gender=="male"]), mle[2])
data = data.frame(c(f, m), c(rep("female", length(f)), rep("male",  length(m))))
colnames(data) <-c("wage", "gender")
return(data)
}
param.diff <- boot(d, sim = "parametric", ran.gen = gen_function, mle = mle, statistic = diff.means.boot, R=1000)
param.diff
plot(param.diff)
param.diff$t
smoothed.diff=kernelboot(
d,
diff.means.boot,
R = 1000,
bw = "default",
kernel = "gaussian",
shrinked = TRUE
)
smoothed.diff$boot.samples
##nonparametric##
quantile(nonparam.diff$t, prob=0.025)
quantile(nonparam.diff$t, prob=0.975)
##parametric##
quantile(param.diff$t, prob=0.025)
quantile(param.diff$t, prob=0.975)
##smoothed##
quantile(smoothed.diff$boot.samples, prob=0.025)
quantile(smoothed.diff$boot.samples, prob=0.975)
